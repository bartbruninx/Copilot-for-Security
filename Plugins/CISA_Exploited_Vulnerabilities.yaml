Descriptor:
  Name: CISA_Exploited_Vulnerabilities
  DisplayName: CISA Known Exploited Vulnerabilities
  Description: CISA maintains the authoritative source of vulnerabilities that have been exploited in the wild. Organizations should use the catalog as an input to their vulnerability management prioritization framework.

SkillGroups:
  - Format: KQL
    Skills:
      - Name: CISA_Exploited_Vulnerabilities
        DisplayName: CISA Known Exploited Vulnerabilities
        Description: CISA maintains the authoritative source of vulnerabilities that have been exploited in the wild. Organizations should use the catalog as an input to their vulnerability management prioritization framework.
        Settings:
          Target: Sentinel
          TenantId: <your_tenant_ID>
          SubscriptionId: <your_subscription_ID>
          ResourceGroupName: <your_RG_name>
          WorkspaceName: <your_WS_name>
          Template: |-
          let CISA_KEV = externaldata (cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime,shortDescription:string,requiredAction:string,dueDate:datetime,knownRansomwareCampaignUse:string,notes:string) [@"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv"] with (ignoreFirstRecord=true, format="csv"); let CISA_KEV = externaldata (cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime,shortDescription:string,requiredAction:string,dueDate:datetime,knownRansomwareCampaignUse:string,notes:string) [@"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv"] with (ignoreFirstRecord=true, format="csv"); CISA_KEV | where cveID  == '{{cve}}' or vendorProject contains '{{vendor}}' or product contains '{{product}}' | top 100 by dateAdded desc
